var un1fyGlobalPath=null;var un1fyPath=null;var un1fyHTMLEdit=null;var un1fyFiles=null;var un1fyFilePath=null;var un1fyImagePath=null;$(function(){unifySetup();$(window).bind("resize",windowResize);$("#logout a").bind("click",logout);$("#un1fyPrefBtn").bind("click",savePrefs);$("#un1fyFTPBtn").bind("click",saveFTP);$("#un1fyFTPClearBtn").bind("click",clearFTPPrompt);$("#un1fyNewUserLink").bind("click",newUser);$("#un1fyNewUserCancel").bind("click",newUserCancel);$("#un1fyDashScrollWrap").height($(window).height()-60);$("#un1fyAutoUpdate").bind("click",autoUpdatePrompt);$("#un1fyMessage").bind("keyup",function(){if(getNoLines(this)>parseInt(this.rows)){this.rows=""+Math.round(parseInt(this.rows)*1.2)}})});var unifySetup=function(){$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");var e;try{e=document.createElement('<iframe name="un1fyPrefsFrame" >')}catch(n){e=document.createElement("iframe")}$(e).attr({id:"un1fyPrefsFrame",name:"un1fyPrefsFrame",src:"../functions/getsaveprefs.php",application:"yes"}).css("display","none");$("body").append(e)};var getGlobals=function(e,n,a,t,r,i){var s=window.location.href.split("/"+e+"/");un1fyGlobalPath=s[0]+"/"+e;un1fyPath=e;un1fyHTMLEdit=n;un1fyFiles=a;un1fyFilePath=t;un1fyImagePath=i;un1fyExFolders=r;changePrefs()};var savePrefs=function(){var e=$("input[name=htmltoggle]:checked").val();$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");var n;try{n=document.createElement('<iframe name="un1fySavePrefsFrame" >')}catch(a){n=document.createElement("iframe")}$(n).attr({id:"un1fySavePrefsFrame",name:"un1fySavePrefsFrame",application:"yes"}).css("display","none");$("body").append(n);$("#un1fyPrefsForm")[0].submit()};var changePrefs=function(){var e=e=window.location.href;var n=e.split("//");n=n[1];$("#un1fyPath").empty();var a=e.split("settings/");a=a[0];$("#un1fyPath").html(a);if(un1fyHTMLEdit=="Y"){$("#htmltoggleon").prop("checked",true);$("#htmltoggleoff").prop("checked",false)}else{$("#htmltoggleoff").prop("checked",true);$("#htmltoggleon").prop("checked",false)}if(un1fyFiles=="Y"){$("#filetoggleon").prop("checked",true);$("#filetoggleoff").prop("checked",false)}else{$("#filetoggleoff").prop("checked",true);$("#filetoggleon").prop("checked",false)}if(un1fyFilePath!=""){$("#un1fyFilePath").val(un1fyFilePath)}if(un1fyImagePath!=""){$("#un1fyImagePath").val(un1fyImagePath)}if(un1fyExFolders!=""){$("#un1fyExFolders").val(un1fyExFolders)}$("#un1fyPrefsFrame, #un1fySavePrefsFrame").remove();if($("#un1fyAcctFormSuperAdmin").length){unifyUsers()}else{$("#un1fyTopBanner").css("background","none")}twitterFeed()};var logout=function(){$.ajax({type:"POST",url:"../functions/logout.php",success:function(){window.location="../../"}})};var showPrompt=function(){$("#un1fyPrompt:hidden").css({display:"block",opacity:"0"}).fadeTo(300,1,function(){if($.browser.msie){$(this)[0].style.removeAttribute("filter")}})};var unifyPromptTop=function(){$("<div/>").attr("id","un1fyPromptTop").appendTo("#un1fyPrompt").append($("<img/>").attr({src:"../unify-images/img_upload_select_top.png",height:"10",width:"353",alt:"top"}))};var unifyPromptBot=function(){$("<div/>").attr("id","un1fyPromptBot").appendTo("#un1fyPrompt").append($("<img/>").attr({src:"../unify-images/img_upload_select_bottom.png",height:"10",width:"353",alt:"top"}))};var cancel=function(){if($("#un1fyPromptWrap").length>0){$("#un1fyPromptWrap").remove()}$("#overlay").fadeTo(300,0,function(){$("#overlay").remove()})};var windowResize=function(){if($("#overlay").length){$("#overlay").css({width:$(window).width(),height:$(window).height()})}};var overlay=function(e){$("<div/>").attr("id","overlay").height($(document).height()).width($(document).width()).appendTo("body").css({display:"block",opacity:"0"}).fadeTo(300,.55)};var userBar=function(e){if($("#un1fyPrompt").length){cancel()}$("#un1fyTopBanner").css("background","none");if(!$("#un1fyUserBar").length){$("<div/>").addClass("un1fyUserBar").attr("id","un1fyUserBar").insertAfter("#un1fyTopBanner").append($("<div/>").addClass("un1fyUserBarIn").attr("id","un1fyUserBarIn").append($("<a/>").attr("href","javascript:").html("Hide This Bar").bind("click",hideUserBar)).append($("<p/>")));if(e.match(/successfully/gi)){$("#un1fyUserBar").find("p").html("<strong>"+e+"</strong>").end().css("opacity","0.4").animate({opacity:"1"},800);var n=setTimeout(function(){$("#un1fyUserBar").animate({opacity:"0"},300,function(){$("#un1fyUserBar").remove()})},3500)}else{$("#un1fyUserBar").find("p").html(e).end().hide().css({opacity:"1.0",backgroundColor:"#c6242b",position:"relative",top:"0",left:"0"}).slideDown(300)}}else{$("#un1fyUserBar").remove();window.clearTimeout(n);userBar(e)}if($("#un1fyNewUser").css("display")=="block"){$("#un1fyNewUser").find("input").val("").end().find("input:first").focus()}};var hideUserBar=function(){if($("#un1fyUserBar").css("position")=="relative"){$("#un1fyUserBar").animate({marginTop:"-26px"},300,function(){$("#un1fyUserBar").remove()})}else{$("#un1fyUserBar").animate({opacity:"0"},200,function(){$("#un1fyUserBar").remove()})}};var v=0;var unifyUsers=function(){var e;try{e=document.createElement('<iframe name="un1fyUsersFrame" >')}catch(n){e=document.createElement("iframe")}$(e).attr({id:"un1fyUsersFrame",name:"un1fyUsersFrame",src:"../functions/getsaveusers.php",application:"yes"}).css("display","none");$("body").append(e)};var adminUser=function(e,n,a){$("#un1fyAcctFormSuperAdmin").find("h3").html(e+" <strong>Admin</strong>").prepend($("<span/>").append($("<a/>").addClass("un1fyAcctModify").attr({href:"javascript:",title:"edit your login information"}).html("modify"))).end().find(".un1fyAcctUserLi input").val(n).end().find(".un1fyAcctEmailLi input").val(a);$("#un1fyAcctFormSuperAdmin a.un1fyAcctModify").unbind("click").bind("click",userModify)};var buildUser=function(e,n,a,t){if(e&&n&&a){if(!$("#user"+t).length){var r='<div id="user'+t+'" class="un1fyDashElement">'+'<form class="un1fyAcctForm un1fyAcctDisplay" action="../functions/getsaveusers.php" method="post" target="un1fySaveUserFrame" >'+"<h3></h3>"+"<ul>"+'<li class="un1fyAcctUserLi">'+"<label>Username </label>"+'<input class="un1fyLocked un1fyAcctUser" name="un1fyAcctUser" type="text" value="" readonly="true" />'+'<input class="un1fyLocked un1fyAcctUser-orig" name="un1fyAcctUser-orig" type="hidden" value="" readonly="true" />'+"</li>"+'<li class="un1fyAcctPassLi">'+"<label>Password </label>"+'<input id="un1fyAcctPass" class="un1fyLocked un1fyAcctPass" name="un1fyAcctPass" type="text" value="TOTALLY SECURE, REALLY" readonly="true" />'+"</li>"+"</ul>"+'<ul class="un1fyAcctMeta">'+'<li class="un1fyAcctEmailLi">'+"<label>Email </label>"+'<input class="un1fyLocked un1fyAcctEmail" name="un1fyAcctEmail" type="text" value="" readonly="true" />'+'<input class="un1fyLocked un1fyAcctEmail-orig" name="un1fyAcctEmail-orig" type="hidden" value="" readonly="true" />'+"</li>"+"</ul>"+"</form>"+"</div>";$userArea=$(r);$userArea.find("h3").html(e).prepend($("<span/>").append($("<a/>").addClass("un1fyAcctModify").attr({href:"javascript:",title:"edit this user"}).html("modify")).append("|").append($("<a/>").addClass("un1fyAcctDelete").attr({href:"javascript:",title:"delete this user"}).html("delete"))).end().find(".un1fyAcctUserLi input").val(n).end().find(".un1fyAcctEmailLi input").val(a);$userArea.find("a.un1fyAcctModify").bind("click",userModify).end().find("a.un1fyAcctDelete").bind("click",function(){userDeletePrompt(this)}).end().insertAfter(".un1fyDashElement:last")}else{$("#user"+t).find("h3").html(e).prepend($("<span/>").append($("<a/>").addClass("un1fyAcctModify").attr({href:"javascript:",title:"edit this user"}).html("modify")).append("|").append($("<a/>").addClass("un1fyAcctDelete").attr({href:"javascript:",title:"delete this user"}).html("delete"))).end().find(".un1fyAcctUserLi input").val(n).end().find(".un1fyAcctEmailLi input").val(a).end().find("a.un1fyAcctModify").unbind("click").bind("click",userModify).end().find("a.un1fyAcctDelete").unbind("click").bind("click",function(){userDeletePrompt(this)})}}};var removeFrames=function(){$("#un1fyUsersFrame, #un1fySaveUserFrame, #un1fyDelUserFrame, #un1fySaveFTPFrame, #un1fyClearFTPFrame").remove();$("#un1fyTopBanner").css("background","none");cancel()};var newUser=function(){userModifyCancel();$("#un1fyNewUser").css("display","block").find("input:first").focus().end().find("#un1fyAcctFormNewUser").addClass("un1fyNewAcctEditing").end().find("#un1fyNewUserSave").bind("click",userModifySave);$("#un1fyNewUserLink").unbind("click").bind("click",newUserCancel);$("#un1fyNewAcctPass").unbind("keyup").bind("keyup",function(){runPassword(this)});setTimeout(function(){$("#un1fyNewName").focus()},0)};var newUserCancel=function(){$("#un1fyNewUser").css("display","none").find("input").val("");$("#pwStrengthNew").removeClass().html('n/a <span class="advice">&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required.</span>');$("#un1fyNewUserLink").unbind("click",newUserCancel).bind("click",newUser)};var userModify=function(){newUserCancel();if(!$(".un1fyAcctPassConLi").length){$(this.parentNode.parentNode.parentNode).addClass("un1fyAcctEditing").find("input").removeAttr("readonly").removeClass("un1fyLocked").addClass("un1fyUnlocked").end().find(".un1fyAcctUserLi").append($("<span/>").addClass("error").html("Please create a username")).end().find(".un1fyAcctPassLi").append($("<span/>").addClass("error").html("&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required.")).after($("<li/>").addClass("un1fyAcctPassConLi").append($("<label/>").html("Confirm Password")).append($("<input/>").addClass("un1fyUnlocked un1fyAcctPassCon").attr({name:"un1fyAcctPassConfirm",type:"password"})).append($("<span/>").addClass("error").html("Must match password"))).after($("<li/>").addClass("un1fyAcctPassInfo").attr("id","pwStrength").html('n/a <span class="advice">&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required. Leave blank if you don&rsquo;t want a new password.</span>')).end().find(".un1fyAcctPassLi label").html("New Password ").end().find(".un1fyAcctPassLi input").replaceWith($("<input/>").attr("id","un1fyAcctPass").addClass("un1fyUnlocked un1fyAcctPass").attr({type:"password",name:"un1fyAcctPass"}).val("")).end().find(".un1fyAcctEmailLi").append($("<span/>").addClass("error").html("Please enter a valid email")).end().find(".un1fyAcctMeta").append($("<li/>").addClass("un1fyFormSave").append($("<a/>").addClass("userSave").attr({href:"javascript:",title:"save"}).html("save").bind("click",userModifySave)).append($("<span/>").addClass("un1fyCancel").html("or ").append($("<a/>").attr("href","javascript:").html("cancel").bind("click",userModifyCancel))))}$("#un1fyAcctPass").unbind("keyup").bind("keyup",function(){runPassword(this)});$("a.un1fyAcctModify").unbind("click",userModify).bind("click",userModifyCancel);$("#un1fyAcctFormSuperAdmin .un1fyAcctUser input:first").focus()};var userModifySave=function(){if(userModifyValid()){$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");var e;try{e=document.createElement('<iframe name="un1fySaveUserFrame" >')}catch(n){e=document.createElement("iframe")}$(e).attr({id:"un1fySaveUserFrame",name:"un1fySaveUserFrame",application:"yes"}).css("display","none");$("body").append(e);$(this).parents(".un1fyAcctForm")[0].submit();userModifyCancel()}};var userModifyValid=function(e){$(".un1fyAcctEditing li.error").removeClass("error");if(e){validCheck(e)}else{var n=0;var a=$(".un1fyAcctEditing input, .un1fyNewAcctEditing input").not(".un1fyAcctUser-orig, .un1fyAcctEmail-orig");a.each(function(){if(validCheck(this)){n++}});$(".un1fyAcctEditing input, .un1fyNewAcctEditing input").not(".un1fyAcctUser-orig, .un1fyAcctEmail-orig").unbind("change").bind("change",function(){validCheck(this)});if(n==a.length){return true}}};var validCheck=function(e){var n=/^[a-zA-Z0-9,!#\$%&'\*\+\/=\?\^_`\{\|}~-]+(\.[a-z0-9,!#\$%&'\*\+\/=\?\^_`\{\|}~-]+)*@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;var a=/^\w*(?=\w*\d)(?=\w*[a-z])(?=\w*[A-Z])\w{5,}$/;var t=false;var r=$(e).val();var i=$(e).attr("class");var s=$(e).parent();if(i.match(/un1fyAcctEmail/g)){if(n.test(r)==true){t=true;s.removeClass("error")}else{s.addClass("error")}}else if(i.match(/un1fyAcctPass\b/)){if($(e).parents(".un1fyAcctEditing").length){if($("#pwStrength").attr("class").match(/strong|medium/)||r==""){t=true;s.removeClass("error")}else{s.addClass("error")}}else{if($("#pwStrengthNew").attr("class").match(/strong|medium/)){t=true;s.removeClass("error")}else{s.addClass("error")}}}else if(i.match(/un1fyAcctPassCon/)){if($(e).parents(".un1fyAcctEditing").length){if(r==$(".un1fyAcctPass",".un1fyAcctEditing").val()){t=true;s.removeClass("error")}else{s.addClass("error")}}else{if(r==$(".un1fyAcctPass",".un1fyNewAcctEditing").val()){t=true;s.removeClass("error")}else{s.addClass("error")}}}if(i.match(/un1fyFTPServer/g)){t=true;s.removeClass("error")}else{if(r!=""){t=true;s.removeClass("error")}else{s.addClass("error")}}return t};var userModifyCancel=function(){$(".un1fyAcctEditing li.error").removeClass("error");$(".un1fyAcctEditing").removeClass("un1fyAcctEditing").find(".un1fyAcctPassInfo").remove().end().find(".un1fyAcctPassLi label").html("Password ").end().find(".un1fyAcctPassLi input").replaceWith($("<input/>").addClass("un1fyLocked").attr({type:"text",name:"un1fyAcctPass"}).val("TOTALLY SECURE, REALLY")).end().find("#pwStrength").remove().end().find("input").removeClass("un1fyUnlocked").addClass("un1fyLocked").attr("readonly","true").end().find(".un1fyAcctPassConLi").remove().end().find(".un1fyFormSave").remove().end().find("li span").remove();$("#un1fyAcctPass").unbind("keyup");$("a.un1fyAcctModify").unbind("click",userModifyCancel).bind("click",userModify)};var userDeletePrompt=function(e){overlay();if(!$("#un1fyPrompt").length){$("body").append($("<div/>").attr("id","un1fyPromptWrap").load("../unify-temps/prompt.html",function(){$("#un1fyPrompt h4.un1fyPromptTitle").html("Delete User");$("#un1fyPrompt p").html("Are you sure you want to delete this user? You cannot undo this action.");$("#un1fyPromptBtn").addClass("un1fyDeleteBtn").attr("title","delete this user").html("delete").bind("click",function(){var n=$(e).parents(".un1fyDashElement").attr("id").replace("user","");userDelete(n)});$("#un1fyCancelBtn").bind("click",cancel);showPrompt()}))}};var userDelete=function(e){$(".un1fyDashElement").not("#un1fySuperAdmin").each(function(){$("#user"+e).remove()});var n;try{n=document.createElement('<iframe name="un1fyDelUserFrame" >')}catch(a){n=document.createElement("iframe")}$(n).attr({id:"un1fyDelUserFrame",name:"un1fyDelUserFrame",src:"../functions/getsaveusers.php?un1fyDelUser="+e,application:"yes"}).css("display","none");$("body").append(n)};var getNoLines=function(e){var n=e.value.split("\n");var a=n.length;for(var t=0,r=n.length;t<r;t++){a+=Math.max(Math.round(n[t].length/e.cols),1)-1}return a};String.prototype.strReverse=function(){var e="";for(var n=0;n<this.length;n++){e=this.charAt(n)+e}return e};var checkPassword=function(e){var n=0,a=0,t=0,r=0,i=0,s=0,o=0,u=0,c=0,f=0,l=0,d=0,p=0,y=0,m=0,h=0,v=0,$=0,g=4,P=4,w=6,A=2,b=2,C=2,k=2,F=3,U=3,T="",E="",L="",S="",B="abcdefghijklmnopqrstuvwxyz",M="01234567890";n=parseInt(e.length*g);a=e.length;var I=e.replace(/\s+/g,"").split(/\s*/),q=I.length;for(var N=0;N<q;N++){if(I[N].match(new RegExp(/[A-Z]/g))){if(T!==""){if(T+1==N){l++;m++}}T=N;t++}else if(I[N].match(new RegExp(/[a-z]/g))){if(E!==""){if(E+1==N){d++;m++}}E=N;r++}else if(I[N].match(new RegExp(/[0-9]/g))){if(N>0&&N<q-1){o++}if(L!==""){if(L+1==N){p++;m++}}L=N;i++}else if(I[N].match(new RegExp(/[^a-zA-Z0-9_]/g))){if(N>0&&N<q-1){o++}if(S!==""){if(S+1==N){y++;m++}}S=N;s++}for(var x=0;x<q;x++){if(I[N].toLowerCase()==I[x].toLowerCase()&&N!=x){f++}}}for(var D=0;D<23;D++){var j=B.substring(D,parseInt(D+3));var R=j.strReverse();if(e.toLowerCase().indexOf(j)!=-1||e.toLowerCase().indexOf(R)!=-1){h++;$++}}for(var D=0;D<8;D++){var j=M.substring(D,parseInt(D+3));var R=j.strReverse();if(e.toLowerCase().indexOf(j)!=-1||e.toLowerCase().indexOf(R)!=-1){v++;$++}}if(t>0&&t<a){n=parseInt(n+(a-t)*2);sAlphaUC="+ "+parseInt((a-t)*2)}if(r>0&&r<a){n=parseInt(n+(a-r)*2);sAlphaLC="+ "+parseInt((a-r)*2)}if(i>0&&i<a){n=parseInt(n+i*P);sNumber="+ "+parseInt(i*P)}if(s>0){n=parseInt(n+s*w);sSymbol="+ "+parseInt(s*w)}if(o>0){n=parseInt(n+o*A);sMidChar="+ "+parseInt(o*A)}if((r>0||t>0)&&s===0&&i===0){n=parseInt(n-a);u=a;sAlphasOnly="- "+a}if(r===0&&t===0&&s===0&&i>0){n=parseInt(n-a);c=a;sNumbersOnly="- "+a}if(f>0){n=parseInt(n-f*f);sRepChar="- "+f}if(l>0){n=parseInt(n-l*b);sConsecAlphaUC="- "+parseInt(l*b)}if(d>0){n=parseInt(n-d*C);sConsecAlphaLC="- "+parseInt(d*C)}if(p>0){n=parseInt(n-p*k);sConsecNumber="- "+parseInt(p*k)}if(h>0){n=parseInt(n-h*F);sSeqAlpha="- "+parseInt(h*F)}if(v>0){n=parseInt(n-v*U);sSeqNumber="- "+parseInt(v*U)}return n};var runPassword=function(e){var n=checkPassword(e.value);var a;var t;var r;if(n<0){n=0}else if(n>100){n=100}if(n>=60){a="strong";t=a+" ("+n+"%)";r="Great password! Now just confirm in the next field."}else if(n>=30&&n<=59){a="medium";t=a+" ("+n+"%)";r="That will do! Now just confirm in the next field."}else{t=a="weak";t=a+" ("+n+"%)";r="&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required. Varied lettercase, numbers, & special characters help."}if($(e).val()==""){$("#pwStrength").removeClass().html('n/a <span class="advice">&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required. Leave blank if you don&rsquo;t want a new password.</span>');if($(e).parents("#un1fyAcctFormNewUser").length){$("#pwStrengthNew").removeClass().html('n/a <span class="advice">&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required.</span>')}}else{var i=$(e).parents("#un1fyAcctFormNewUser").length?"#pwStrengthNew":"#pwStrength";$(i).removeClass().addClass(a).html(t+' <span class="advice">'+r+"</span>")}};var countContain=function(e,n){var a=0;for(i=0;i<e.length;i++){if(n.indexOf(e.charAt(i))>-1){a++}}return a};var formatTweet=function(e){var n=e.match(/http[^\s]+/gi);if(n){for(var a=0;a<n.length;a++){e=e.replace(n[a],'<a href="'+n[a]+'">'+n[a]+"</a>")}}var t=e.match(/^@[^\s]+|\s@[^\s]+\b/gi);if(t){for(var a=0;a<t.length;a++){t[a]=t[a].replace(" ","");t[a]=t[a].replace(":","");var r=t[a].replace(/@/,"");e=e.replace(t[a],'@<a href="http://twitter.com/'+r+'">'+r+"</a>")}}var i=e.match(/#[^\s]+/gi);if(i){for(var a=0;a<i.length;a++){i[a]=i[a].replace(" ","");i[a]=i[a].replace(":","");var s=i[a].replace(/#/,"");e=e.replace(i[a],'#<a href="http://twitter.com/search?q=#'+s+'">'+s+"</a>")}}return e};var formatTweetDate=function(e){var n=e.split(" ");switch(n[1]){case"Jan":n[1]="00";break;case"Feb":n[1]="01";break;case"Mar":n[1]="02";break;case"Apr":n[1]="03";break;case"May":n[1]="04";break;case"Jun":n[1]="05";break;case"Jul":n[1]="06";break;case"Aug":n[1]="07";break;case"Sep":n[1]="08";break;case"Oct":n[1]="09";break;case"Nov":n[1]="10";break;case"Dec":n[1]="11";break}n=new Date(n[5],n[1],n[2]);return n.getMonth()+1+"/"+n.getDay()+"/"+n.getFullYear()+" - "};var twitterFeed=function(){$.ajax({type:"GET",crossDomain:true,url:"http://api.twitter.com/statuses/user_timeline/unifysupport.json?count=100&exclude_replies",dataType:"jsonp",success:function(e){var n="";var a=0;$(e).each(function(t){var r=this.text;var i=this.created_at;if(!r.match(/^@/gi)){a++;n+="<li>"+formatTweetDate(i)+formatTweet(r)+"</li>";if(a==5||t==e.length-1){$("#twitter_update_list").html(n);return false}}})}})};var saveFTP=function(){if(FTPvalid()){$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");var e;try{e=document.createElement('<iframe name="un1fySaveFTPFrame" >')}catch(n){e=document.createElement("iframe")}$(e).attr({id:"un1fySaveFTPFrame",name:"un1fySaveFTPFrame",application:"yes"}).css("display","none");$("body").append(e);$("#un1fyFTPForm")[0].submit()}};var clearFTPPrompt=function(e){overlay();if(!$("#un1fyPrompt").length){$("body").append($("<div/>").attr("id","un1fyPromptWrap").load("../unify-temps/prompt.html",function(){$("#un1fyPrompt h4.un1fyPromptTitle").html("Clear FTP Info");$("#un1fyPrompt p").html("Are you sure you want to clear your FTP info? You cannot undo this.");$("#un1fyPromptBtn").addClass("un1fyPromptBtn").attr("title","clear").html("clear").bind("click",function(){clearFTP()});$("#un1fyCancelBtn").bind("click",cancel);showPrompt()}))}};var clearFTP=function(){$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");var e;try{e=document.createElement('<iframe name="un1fyClearFTPFrame" >')}catch(n){e=document.createElement("iframe")}$(e).attr({id:"un1fyClearFTPFrame",name:"un1fyClearFTPFrame",application:"yes",src:"../functions/ftpclear.php"}).css("display","none");$("body").append(e)};var clearFTPInfo=function(){$("#un1fyFTPForm input").val("")};var FTPvalid=function(e){e=e||false;$("#un1fyFTPForm li.error").removeClass("error");if(e){validCheck(e)}else{var n=0;var a=$("#un1fyFTPForm input");a.each(function(){if(validCheck(this)){n++}});$("#un1fyFTPForm input").unbind("change").bind("change",function(){validCheck(this)});if(n==a.length){return true}}};var autoUpdatePrompt=function(){overlay();if(!$("#un1fyPrompt").length){$("body").append($("<div/>").attr("id","un1fyPromptWrap").load("../unify-temps/prompt.html",function(){$("#un1fyPrompt h4.un1fyPromptTitle").html("Auto-Update Unify");$("#un1fyPrompt p").addClass("simple").html("Are you sure you want to update? Your preferences, FTP info, and restore states will be preserved. You cannot undo or cancel once you start the auto-update process. It should take less than 3 minutes.");$("#un1fyPromptBtn").addClass("un1fyPromptBtn").attr("title","Auto-update unify to the latest version").html("update").bind("click",autoUpdate);$("#un1fyCancelBtn").bind("click",cancel);showPrompt()}))}};var autoUpdate=function(){$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");$("#un1fyPrompt h4.un1fyPromptTitle").html("Auto-Updating&hellip; Please Wait");$("#un1fyPrompt p").html("Uploading the new files now. Please do not refresh your browser or stop loading.");$("#un1fyPromptBtn,#un1fyCancelBtn").remove();var e;try{e=document.createElement('<iframe name="un1fyUpdateFrame" >')}catch(n){e=document.createElement("iframe")}$(e).attr({id:"un1fyUpdateFrame",name:"un1fyUpdateFrame",application:"yes",src:"../functions/updatestart.php"}).css("display","none");$("body").append(e)};var autoUpdateSuccess=function(){$("#un1fyPrompt h4.un1fyPromptTitle").html("Auto-Update was Successful!");$("#un1fyPrompt p").html("You are now updated to the latest version of Unify. Please click &ldquo;done&rdquo;.");$("#un1fyPromptInsert").append($("<a/>").attr({id:"un1fyPromptBtn",href:"javascript:"}).addClass("un1fyPromptBtn").attr("title","Start using the latest Unify!").html("done").bind("click",reloadPage))};var reloadPage=function(){window.location.reload(true);window.location.reload(true)};